#+Startup: overview

* Interface Tweaks & Server
  - custom-set-faces was added by Custom. 
    If you edit it by hand, you could mess it up, so be careful. Your
    init file should contain only one such instance. If there is more
    than one, they won't work right.
    #+BEGIN_SRC emacs-lisp
      (custom-set-faces
       '(fg:erc-color-face12 ((t (:foreground "deep sky blue"))))
       '(iedit-occurrence ((t (:inherit highlight :background "yellow")))))
    #+END_SRC
  - set font face
    #+BEGIN_SRC emacs-lisp
      ;; (set-face-attribute 'default nil :font "ProggyTinySZ-12") ;; Bitmap font
      ;; (set-face-attribute 'default nil :font "ProggyTinyTTSZ-14") ;; Truetype font
      ;; (set-face-attribute 'default nil :font "") ;; Truetype font
      ;; (set-face-attribute 'default nil :font "Inconsolata-10") ;; Truetype font
      ;; (set-face-attribute 'default nil :font "DejaVuSansMono-10") ;; Truetype font
      (set-face-attribute 'default nil :font "PragmataPro-6") ;; Truetype font
      ;; (set-face-attribute 'default nil :font "terminusicons2") ;; Icon Font
      ;; (set-default-font "Inconsolata 10")
    #+END_SRC
  - set the font size
    #+BEGIN_SRC emacs-lisp
      (set-face-attribute 'default nil :height 100)
    #+END_SRC
  - inhibit splash screen
    #+BEGIN_SRC emacs-lisp
      (setq inhibit-startup-message t)
    #+END_SRC
  - make emacs transparent
    #+BEGIN_SRC emacs-lisp
      (set-frame-parameter (selected-frame) 'alpha '(85 85))
      (add-to-list 'default-frame-alist '(alpha 85 85))
    #+END_SRC
  - make history length longer
    #+BEGIN_SRC emacs-lisp
      (setq history-length 1000)
    #+END_SRC
  - enable visual bell
    #+BEGIN_SRC emacs-lisp
      (setq visible-bell 1)
    #+END_SRC
  - set theme
    #+BEGIN_SRC emacs-lisp
      (use-package moe-theme
        :ensure t
      )
      ;; (load-theme 'leuven)
      (load-theme 'tsdh-dark)
    #+END_SRC
  - set the width of simple html reader to a more comforting value
    #+BEGIN_SRC emacs-lisp
      (setq shr-width 80)
    #+END_SRC

   - Make sure the server is running, in order to let other connect to
     this instance
     #+BEGIN_SRC emacs-lisp
       (server-start)
     #+END_SRC

* Loadpaths
  Add folders to the load-path
  #+BEGIN_SRC emacs-lisp
    (add-to-list 'load-path "~/.emacs.d/color-theme/")
    (add-to-list 'load-path "~/.emacs.d/color-theme/themes/")
    (add-to-list 'load-path "~/.emacs.d/calendar/")
    (add-to-list 'load-path "~/.emacs.d/elim/")
    (add-to-list 'load-path "~/.emacs.d/elim/elisp/")
    (add-to-list 'load-path "~/.emacs.d/flycheck/")
    (add-to-list 'load-path "~/.emacs.d/neotree/")
    (add-to-list 'load-path "~/.emacs.d/nginx-mode/")
    (add-to-list 'load-path "~/.nix-profile/share/emacs/site-lisp/mu4e/")
  #+END_SRC

* Key-Bindings
  Define custom key bindings

  - ibuffer-mode
    #+BEGIN_SRC emacs-lisp
      (global-set-key (kbd "C-x C-b") 'ibuffer)
    #+END_SRC

  - set global print key
    #+BEGIN_SRC emacs-lisp
      (global-set-key (kbd "<print>") 'print-buffer)
    #+END_SRC

  - other bindings
    #+BEGIN_SRC emacs-lisp
      (global-set-key (kbd "C-= C-=") 'er/expand-region)
      (global-set-key (kbd "C-<tab>") 'other-window)
      (global-set-key (kbd "M-<tab>") 'other-frame)
      (global-set-key (kbd "<f5>")    'revert-buffer)
      (global-set-key (kbd "C-z")     'undo)
      (global-set-key (kbd "M-*")     'pop-tag-mark)
      (global-set-key (kbd "C-<f7>")  'simple-mpc)
      (global-set-key (kbd "C-x q")    'bury-buffer)
    #+END_SRC

* Org-Mode Config
** org
#+BEGIN_SRC emacs-lisp
  (use-package org
    :ensure t
    :config
    (setq org-startup-indented t)
    ; v-- via: https://github.com/org-roam/org-roam/issues/2198 in order to show links in org-roam backlink buffer in descriptive form
    ; (setq org-fold-core-style "overlays")
    (with-eval-after-load 'org       
      (add-hook 'org-mode-hook #'visual-line-mode))

    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    ;; Open new file within current window
    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    (defun org-force-open-current-window ()
      (interactive)
      (let ((org-link-frame-setup (quote
                                   ((vm . vm-visit-folder)
                                    (vm-imap . vm-visit-imap-folder)
                                    (gnus . gnus)
                                    (file . find-file)
                                    (wl . wl)))
                                  ))
        (org-open-at-point)))

    ;; Depending on universal argument try opening link
    (defun org-open-maybe (&optional arg)
      (interactive "P")
      (if arg
          (org-open-at-point)
        (org-force-open-current-window)
        )
      )
    ;; Redefine file opening without clobbering universal argumnet
    (define-key org-mode-map "\C-c\C-o" 'org-open-maybe)

    :pin gnu
    )
#+END_SRC
** ox-latex
   #+BEGIN_SRC emacs-lisp
     (use-package ox-latex
     :config
     ;; Org's Latex Exporter configurations sction
     (setq org-latex-pdf-process
           '("pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"
             "pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"
             "pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"))
     (setq org-export-latex-listings 'minted)
     (add-to-list 'org-latex-packages-alist '("" "minted"))
     
     ;; for bigger latex preview in org-mode (C-c C-x C-l)
     (plist-put org-format-latex-options :scale 1.8)
     )
   #+END_SRC
** ox-md
   #+BEGIN_SRC emacs-lisp
     (use-package ox-md
     )
   #+END_SRC
** ox-koma-letter
# #+BEGIN_SRC emacs-lisp
#   (use-package ox-koma-letter
#     :ensure org-contrib
#     :config
#     (add-to-list 'org-latex-classes
#                  '("my-letter"
#                    "\\documentclass\{scrlttr2\}
#      \\usepackage[english]{babel}
#      \\setkomavar{frombank}{(1234)\\,567\\,890}
#      \[DEFAULT-PACKAGES]
#      \[PACKAGES]
#      \[EXTRA]"))
#     (setq org-koma-letter-default-class "my-letter")
#     :pin gnu
#     )
# #+END_SRC

#+begin_src emacs-lisp
  (add-to-list 'load-path "~/.emacs.d/ox-koma-letter/")
  (require 'ox-koma-letter)
#+end_src
** COMMENT org-mu4e
   #+BEGIN_SRC emacs-lisp
   (use-package org-mu4e
   :config 
   (setq org-mu4e-convert-to-html t)
   )
   #+END_SRC
** org-protocol
   #+BEGIN_SRC emacs-lisp
     (use-package org-protocol)
   #+END_SRC
** org-capture
   #+BEGIN_SRC emacs-lisp
     (use-package org-capture
       :ensure f
       :init
       (add-to-list 'load-path "~/.emacs.d/org-latest/contrib")
       (add-to-list 'load-path "~/.emacs.d/org-latest/lisp")
       (add-to-list 'load-path "~/.emacs.d/org-latest/contrib/lisp")

       :config
       (setq org-capture-templates '(("i" "Item [inbox]" entry
                                      (file "~/Org/inbox.org")
                                      "* TODO %i%?")
                                     ("L" "Link" entry
                                      (file "~/Dropbox/Zettelkasten/Notizen.org")
                                      "* TODO %a %?\n %T\n %i")
                                     ("T" "Timed" entry
                                      (file+headline "~/Org/timed.org" "Timed")
                                      "* %i%? \n %U")
                                     ("w" "Url [inbox]" entry
                                      (file "~/Org/inbox.org")
                                      "* TODO %?[[%:link][%:description]]")
                                     ("W" "Url with Text [inbox]" entry
                                      (file "~/Org/inbox.org")
                                      "* TODO %?[[%:link][%:description]] \n  %:initial")
                                     ))
       )
   #+END_SRC
** COMMENT org-capture-pop-frame
   #+BEGIN_SRC emacs-lisp
   (use-package org-capture-pop-frame
   :ensure f
   :init
   (add-to-list 'load-path "~/.emacs.d/org-latest/contrib")
   (add-to-list 'load-path "~/.emacs.d/org-latest/lisp")
   (add-to-list 'load-path "~/.emacs.d/org-latest/contrib/lisp")
   )
   #+END_SRC
** org-install
   #+BEGIN_SRC emacs-lisp
   (use-package org-install
   :ensure f
   :init
   (add-to-list 'load-path "~/.emacs.d/org-latest/contrib")
   (add-to-list 'load-path "~/.emacs.d/org-latest/lisp")
   (add-to-list 'load-path "~/.emacs.d/org-latest/contrib/lisp")
   )
   #+END_SRC
** agenda
   Set the agenda files to my agenda fileset:
   #+BEGIN_SRC emacs-lisp
     (setq org-agenda-files
           '("~/Org/inbox.org"
             "~/Org/current.org"
             "~/Org/timed.org"
             "~/Dropbox/Zettelkasten/Roam/Literaturnotizen.org"
             "~/Dropbox/Zettelkasten/Roam"
             "~/Dropbox/Zettelkasten/Roam/daily"
             ;; "~/Dropbox/Apps/frosch03s org-web/Tasks.org"
             ))
     ;; (setq org-agenda-file-regexp "\\`[^.].*\\.org\\'")
     (setq org-agenda-file-regexp "[0-9]\\{14\\}-[^.]*\\.org$\\|[0-9]\\{4\\}-[0-9]\\{2\\}-[0-9]\\{2\\}.org$")
   #+END_SRC

   Define the files one is able to refile stuff into:
   #+BEGIN_SRC emacs-lisp
     (setq org-refile-use-outline-path t)

     (setq org-refile-targets '((nil :maxlevel . 9)
                                (org-agenda-files :maxlevel . 9)))
     (setq org-outline-path-complete-in-steps nil)         ; Refile in a single go
     (setq org-refile-use-outline-path t)                  ; Show full paths for refiling

     ;; (setq org-refile-targets '(("~/Org/current.org" :maxlevel . 2)
     ;;                            ("~/Org/future.org" :level . 1)
     ;;                            ("~/Org/timed.org" :maxlevel . 2)))
   #+END_SRC

   Set the default todo types:
   #+BEGIN_SRC emacs-lisp
     (setq org-todo-keywords '((sequence "TODO" "DONE")))
   #+END_SRC

   Start emacs within Org's Agenda mode. 
   #+BEGIN_SRC emacs-lisp
     (add-hook 'after-init-hook 'org-agenda-list)
   #+END_SRC

   #+BEGIN_SRC emacs-lisp
     ;; starte agenda in ganzem fenster
     (setq org-agenda-window-setup 'current-window)

     ;; Tasks mit Prioriäten unterschiedlich darstellen:
     (setq org-agenda-fontify-priorities 
           (quote ((65 (:foreground "Red")) (66 (:foreground "Blue")) (67 (:foreground "Darkgreen")))))

     (setq org-agenda-date-weekend (quote (:foreground "Yellow" :weight bold)))


     (define-key mode-specific-map [?a] 'org-agenda)

     (eval-after-load "org"
       '(progn
          (define-prefix-command 'org-todo-state-map)

          (define-key org-mode-map "\C-cx" 'org-todo-state-map)

          (define-key org-todo-state-map "x"
            #'(lambda nil (interactive) (org-todo "CANCELLED")))
          (define-key org-todo-state-map "d"
            #'(lambda nil (interactive) (org-todo "DONE")))
          ;; (define-key org-todo-state-map "f"
          ;;   #'(lambda nil (interactive) (org-todo "DEFERRED")))
          (define-key org-todo-state-map "w"
            #'(lambda nil (interactive) (org-todo "WAITING")))
          ;; (define-key org-todo-state-map "s"
          ;;   #'(lambda nil (interactive) (org-todo "STARTED")))
          ;; (define-key org-todo-state-map "w"
          ;;   #'(lambda nil (interactive) (org-todo "WAITING")))

          (eval-after-load "org-agenda"
            '(progn 
               (define-key org-agenda-mode-map "\C-n" 'next-line)
               (define-key org-agenda-keymap "\C-n" 'next-line)
               (define-key org-agenda-mode-map "\C-p" 'previous-line)
               (define-key org-agenda-keymap "\C-p" 'previous-line)
               )
            )
          )
       )

   #+END_SRC

** COMMENT bullets
   Org-Mode Bullets - for nice looking org-mode bullet items
   #+BEGIN_SRC emacs-lisp
     (use-package org-bullets
       :hook (org-mode . org-bullets-mode)
       :config
       (setq org-bullets-bullet-list '("◉" "⁑" "⁂" "❖" "✮" "✱" "✸")))
     
     ;; (use-package org-bullets
     ;;   :ensure f
     ;;   :config
     ;;   (autoload 'org-bullets "org-bullets")
     ;;   (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1)))
     ;;   )
   #+END_SRC

** ditaa & plantuml
   - setup paths
     #+BEGIN_SRC emacs-lisp
       (setq org-ditaa-jar-path "~/bin/ditaa.jar")
       (setq org-plantuml-jar-path "~/bin/plantuml.jar")
     #+END_SRC
   - Use fundamental mode when editing plantuml blocks with C-c '
     #+BEGIN_SRC emacs-lisp
       (add-to-list 'org-src-lang-modes (quote ("plantuml" . fundamental)))
     #+END_SRC

** babel
   # - Make babel results blocks lowercase
     # #+BEGIN_SRC emacs-lisp
     # (setq org-babel-results-keyword "results")
     # #+END_SRC

   - list of loaded languages
     #+BEGIN_SRC emacs-lisp
       (org-babel-do-load-languages
        (quote org-babel-load-languages)
        (quote ((emacs-lisp . t)
                (dot . t)
                (ditaa . t)
                (R . t)
                (python . t)
                (ruby . t)
                (gnuplot . t)
                (clojure . t)
                (shell . t)
                (ledger . t)
                (org . t)
                (plantuml . t)
                (latex . t))))
     #+END_SRC

                #+results:

   - inhibit prompt to confirm evaluation

     This may be dangerous - make sure you understand the consequences
     of setting this -- see the docstring for details
     #+BEGIN_SRC emacs-lisp
     (setq org-confirm-babel-evaluate nil)
     #+END_SRC

** image handling
   #+BEGIN_SRC emacs-lisp
     (setq org-image-actual-width 300)

     (defun bh/display-inline-images ()
       (condition-case nil
           (org-display-inline-images)
         (error nil)))

     (add-hook 'org-babel-after-execute-hook 'bh/display-inline-images 'append)
   #+END_SRC

** keybindings
   #+BEGIN_SRC emacs-lisp
     ;; set keys to link
     (global-set-key (kbd "C-c C-l") 'org-store-link)
     (global-set-key (kbd "C-c l") 'org-insert-link)
     (define-key global-map "\C-cc" 'org-capture)
     (global-set-key (kbd "C-S-<f10>")   'org-agenda-list)
     (global-set-key (kbd "C-S-<f11>")   'org-mobile-push)
     (global-set-key (kbd "C-S-<f12>")   'org-mobile-pull)
   #+END_SRC
** file associations
   #+BEGIN_SRC emacs-lisp
     (eval-after-load "org"
       '(progn
          ;; .txt files aren't in the list initially, but in case that changes
          ;; in a future version of org, use if to avoid errors
          (if (assoc "\\.txt\\'" org-file-apps)
              (setcdr (assoc "\\.txt\\'" org-file-apps) "notepad.exe %s") 
            (add-to-list 'org-file-apps '("\\.txt\\'" . "notepad.exe %s") t))
          ;; Change .pdf association directly within the alist
          (setcdr (assoc "\\.pdf\\'" org-file-apps) "mupdf %s")))

     (setq org-src-fontify-natively t)

     (add-to-list 'auto-mode-alist '("\\.org$" . org-mode))
   #+END_SRC
** org publish
#+BEGIN_SRC emacs-lisp
  (require 'ox-publish)
  (setq org-publish-project-alist
        '(
          ("newblog-posts"
           :base-directory "~/Documents/NewBlog/"
           :base-extension "org"
           :publishing-directory "/ssh:frosch03@frosch03.de:/home/frosch03/frosch03.de/www/posts/"
           :recursive t
           :publishing-function org-html-publish-to-html
           :headline-levels 4             ; Just the default for this project.
           :auto-preamble t
           ;; :auto-sitemap t
           ;; :sitemap-title "frosch03.de/posts"
           ;; :sitemap-filename "index.org"
           ;; :sitemap-style list
           ;; :author "Matthias Brettschneider"
           ;; :email "frosch03@frosch03.de"
           ;; :with-creator t
           )
          ("newblog-img"
           :base-directory "~/Documents/NewBlog/img/"
           :base-extension "png\\|jpg\\|gif\\|svg"
           :publishing-directory "/ssh:frosch03@frosch03.de:/home/frosch03/frosch03.de/www/posts/img/"
           :recursive t
           :publishing-function org-publish-attachment
           )
          ("newblog-data"
           :base-directory "~/Documents/NewBlog/data/"
           :base-extension "pdf"
           :publishing-directory "/ssh:frosch03@frosch03.de:/home/frosch03/frosch03.de/www/posts/data/"
           :recursive t
           :publishing-function org-publish-attachment
           )
          ("local-newblog-posts"
           :base-directory "~/Documents/NewBlog/"
           :base-extension "org"
           :publishing-directory "~/Documents/NewBlog/local/"
           :recursive t
           :publishing-function org-html-publish-to-html
           :headline-levels 4             ; Just the default for this project.
           :auto-preamble t
           :auto-sitemap t
           :sitemap-title "frosch03.de/posts"
           :sitemap-filename "sitemap.org"
           :sitemap-style list
           :author "Matthias Brettschneider"
           :email "frosch03@frosch03.de"
           :with-creator t
          )
          ("local-newblog-img"
           :base-directory "~/Documents/NewBlog/img/"
           :base-extension "png\\|jpg\\|gif\\|svg"
           :publishing-directory "~/Documents/NewBlog/local/img/"
           :recursive t
           :publishing-function org-publish-attachment
          )
          ("local-newblog-data"
           :base-directory "~/Documents/NewBlog/data/"
           :base-extension "pdf"
           :publishing-directory "~/Documents/NewBlog/local/data/"
           :recursive t
           :publishing-function org-publish-attachment
          )
          ("newblog" :components ("newblog-posts" "newblog-img" "newblog-data"))
          ("local-newblog" :components ("local-newblog-posts" "local-newblog-img" "local-newblog-data"))
         )
  )
#+END_SRC
* Dired Config
** Configuring loadpath:
   #+BEGIN_SRC emacs-lisp
     (add-to-list 'load-path "~/.emacs.d/dired/")
   #+END_SRC
** COMMENT dired+
   #+BEGIN_SRC emacs-lisp
   (use-package dired+
   :ensure f
   :config
   ;; Omit some file \\
   ;; dired-omit-files contains the regex of the files to hide in Dired
   ;; Mode. For example, if you want to hide the files that begin with
   ;; . and #, set that variable like this
   (setq-default dired-omit-files "^\\.?#\\|^\\.$\\|^\\.\\.$\\|^\\.")
   (add-to-list 'dired-omit-extensions ".hi") ;; hide haskell .hi files

   ;; Always copy & delete directories recursively
   (setq dired-recursive-copies 'always)
   (setq dired-recursive-deletes 'always)

   ;; Auto guess target \\
   ;; Set this variable to non-nil, Dired will try to guess a default
   ;; target directory. This means: if there is a dired buffer displayed
   ;; in the next window, use its current subdir, instead of the current
   ;; subdir of this dired buffer. The target is used in the prompt for
   ;; file copy, rename etc.
   (setq dired-dwim-target t)

   ;; Delete by moving to Trash
   (setq delete-by-moving-to-trash t
         trash-directory "/tmp/trash")

   ;; Configure the listing of files \\
   ;; The variable dired-listing-switches specifies the extra argument
   ;; that you want to pass to ls command. For example, calling ls
   ;; –group-directories-first will result in ls sort the directories
   ;; first in the output. To let Emacs pass that argument to ls, use
   ;; this code
   (setq dired-listing-switches "--group-directories-first -alh")
   )
   #+END_SRC
** dired-x
   #+BEGIN_SRC emacs-lisp
   (use-package dired-x
   :ensure f)
   #+END_SRC
** COMMENT dired-details+
   #+BEGIN_SRC emacs-lisp
   (use-package dired-details+
   :ensure t
   :config
   ;; Show dired detils like sym-links
   (setq dired-details-hide-link-targets nil)
   )
   #+END_SRC
** dired-rainbow
   #+BEGIN_SRC emacs-lisp
   (use-package dired-rainbow
   :ensure t
   :config
   ;; Configure extensions of audio files
   (defconst dired-audio-files-extensions
     '("mp3" "MP3" "ogg" "OGG" "flac" "FLAC" "wav" "WAV")
     "Dired Audio files extensions")
   (dired-rainbow-define audio "#329EE8" dired-audio-files-extensions)

   ;; Configure extensions of video files
   (defconst dired-video-files-extensions
     '("vob" "VOB" "mkv" "MKV" "mpe" "mpg" "MPG" "mp4" "MP4" "ts" "TS" "m2ts"
       "M2TS" "avi" "AVI" "mov" "MOV" "wmv" "asf" "m2v" "m4v" "mpeg" "MPEG" "tp")
     "Dired Video files extensions")
   (dired-rainbow-define video "#B3CCFF" dired-video-files-extensions)
   )
   #+END_SRC
** dired-filter
   #+BEGIN_SRC emacs-lisp
   (use-package dired-filter
   :ensure t)
   #+END_SRC
** Startup dired within home directory by S-<F1>
   #+BEGIN_SRC emacs-lisp
     (global-set-key (kbd "S-<f1>")
                     (lambda ()
                       (interactive)
                       (dired "~/")))
   #+END_SRC
* ERC irc
  #+BEGIN_SRC emacs-lisp
    (use-package erc
    :ensure t)
  #+END_SRC
* COMMENT Latex Config
- Loading up
  #+BEGIN_SRC emacs-lisp
  (autoload 'reftex "reftex" "RefTeX")
  (load "auctex.el" nil t t)
  #+END_SRC
- Configure some load-hooks
  #+BEGIN_SRC emacs-lisp
     ;; (add-hook 'TeX-language-de-hook 
     ;;           (lambda () (ispell-change-dictionary "german")))
     (add-hook 'LaTeX-mode-hook 'turn-on-reftex)
    (defun fill-latex-mode-hook ()
       "LaTeX setup."
       (setq fill-column 130))
     (add-hook 'LaTeX-mode-hook 'fill-latex-mode-hook)
    (fset 'my-latex-write-and-view
           [?\C-x ?\C-s ?\C-c ?\C-c return])
     (add-hook 'LaTeX-mode-hook (lambda () 
                                  (local-set-key (kbd "<f5>") 'my-latex-write-and-view)))
    (defun my-latex-highlight-owninlinecode ()
       "Highlight own inline code"
       (highlight-regexp "\\hs{[^\}]*}" 'hi-green-b))
     (add-hook 'LaTeX-mode-hook 'my-latex-highlight-owninlinecode)
    (defun my-latex-highlight-todos ()
       "Highlight Todo's"
       (highlight-regexp "\\todo{[^\}]*}" 'hi-red-b))
     (add-hook 'LaTeX-mode-hook 'my-latex-highlight-todos)
    (add-hook 'LaTeX-mode-hook (lambda () 
                                  (local-set-key (kbd "<f12>") 'highlight-changes-mode)))
 #+END_SRC
- Query for master file
  #+BEGIN_SRC emacs-lisp
    (setq-default TeX-master nil)
  #+END_SRC
- Highlight special words within latex files
  #+BEGIN_SRC emacs-lisp
    (defface my-green-b '((t  (:foreground  "green"               
                                            )))  "green-face")
   (font-lock-add-keywords 'latex-mode 
      										  '( ("\\\\hs"   0 'my-green-b prepend)
      											   ("\\\\todo" 0 'hi-red     prepend)
                               )
                            )
  #+END_SRC
- Add the -shell-escape to the compiling command for the minted
  sourcecode package
  #+BEGIN_SRC emacs-lisp
    (eval-after-load "tex" 
      '(setcdr (assoc "LaTeX" TeX-command-list)
               '("%`%l%(mode) -shell-escape%' %t"
                 TeX-run-TeX nil (latex-mode doctex-mode) :help "Run LaTeX")
               )
      )
  #+END_SRC
- Disable narrowing to latex environment
  #+BEGIN_SRC emacs-lisp
    (put 'LaTeX-narrow-to-environment 'disabled nil)
  #+END_SRC
* Markdown-Mode
#+BEGIN_SRC emacs-lisp
(use-package markdown-mode
:ensure t
:config
(setq auto-mode-alist
      (cons '("\\.md" . markdown-mode) auto-mode-alist))
)

#+END_SRC
* Magit
#+BEGIN_SRC emacs-lisp
(use-package magit
:ensure t
:config
(global-set-key (kbd "C-x g") 'magit-status)
)
#+END_SRC
* Haskell
** Configure loadpath
#+BEGIN_SRC emacs-lisp
(add-to-list 'load-path "~/.emacs.d/haskell-mode/")
#+END_SRC

** haskell-mode
#+BEGIN_SRC emacs-lisp
  (use-package haskell-mode
  :ensure t
  :config
  ;; Setup some hooks
  (add-hook 'haskell-mode-hook 'turn-on-haskell-doc-mode)
  (add-hook 'haskell-mode-hook 'turn-on-haskell-indent)
  (add-hook 'haskell-mode-hook (lambda () 
                                 (local-set-key (kbd "M-.") 'haskell-mode-tag-find)))
  ;; (add-hook 'haskell-mode-hook (lambda ()
  ;;                                (set-variable 'projectile-tags-command "hasktags --etags %s")))
  (add-hook 'haskell-mode-hook 'interactive-haskell-mode)
  ;; (setq haskell-hasktags-path "/home/frosch03/.cabal/bin/hasktags")
  ;; Set C-c C-c to compile haskell with the haskell mode compile options
  (eval-after-load "haskell-mode"
      '(define-key haskell-mode-map (kbd "C-c C-c") 'haskell-compile))
  (eval-after-load "haskell-cabal"
      '(define-key haskell-cabal-mode-map (kbd "C-c C-c") 'haskell-compile))

  ;; Enable spell checking for comments and strings only 
  ;; (add-hook 'haskell-mode-hook 'flyspell-prog-mode)

  ;; Define default info directory
  (add-to-list 'Info-default-directory-list "~/.emacs.d/haskell-mode/")
  )
#+END_SRC

** haskell-cabal
#+BEGIN_SRC emacs-lisp
(use-package haskell-cabal
:ensure f)
#+END_SRC

** haskell-interactive-mode
#+BEGIN_SRC emacs-lisp
(use-package haskell-interactive-mode
:ensure f)
#+END_SRC

** haskell-process
#+BEGIN_SRC emacs-lisp
(use-package haskell-process
:ensure f
:config
(custom-set-variables
  '(haskell-process-suggest-remove-import-lines t)
  '(haskell-process-auto-import-loaded-modules t)
  '(haskell-process-log t))
)
#+END_SRC
* Flyspell
- Define flyspell switch language function
#  #+BEGIN_SRC emacs-lisp
#    (defun fd-switch-dictionary()
#      (interactive)
#      (let* ((dic ispell-current-dictionary)
#             (change (if (string= dic "deutsch8") "english" "deutsch8")))
#        (ispell-change-dictionary change)
#        (message "Dictionary switched from %s to %s" dic change)
#        ))
#  #+END_SRC
- Define function that checks next highlighted word
#  #+BEGIN_SRC emacs-lisp
#    (defun flyspell-check-next-highlighted-word ()
#      "Custom function to spell check next highlighted word"
#      (interactive)
#      (flyspell-goto-next-error)
#      (ispell-word)
#      )
#  #+END_SRC
- Disable in Haskell mode
#  #+BEGIN_SRC emacs-lisp
#    (dolist (hook '(haskell-mode-hook))
#          (add-hook hook (lambda () (flyspell-mode -1))))
#  #+END_SRC
- Setup keybindings
#  #+BEGIN_SRC emacs-lisp
#    (global-set-key (kbd "<f9>")       'fd-switch-dictionary)
#    (global-set-key (kbd "C-S-<f8>")   'flyspell-mode)
#    (global-set-key (kbd "C-M-S-<f8>") 'flyspell-buffer)
#    (global-set-key (kbd "C-<f8>")     'flyspell-check-previous-highlighted-word)
#    (global-set-key (kbd "M-<f8>")     'flyspell-check-next-highlighted-word)
#  #+END_SRC
* Flymake
#+BEGIN_SRC emacs-lisp
(use-package flymake
:ensure t
:config
;; Define function to make haskell code on the fly
(defun flymake-Haskell-init ()
  (flymake-simple-make-init-impl
   'flymake-create-temp-with-folder-structure nil nil
   (file-name-nondirectory buffer-file-name)
   'flymake-get-Haskell-cmdline))

(defun flymake-get-Haskell-cmdline (source base-dir)
  (list "flycheck_haskell.pl"
        (list source base-dir)))

;; Attach functionality to filetypes
(push '(".+\\.hs$" flymake-Haskell-init flymake-simple-java-cleanup)
      flymake-allowed-file-name-masks)
(push '(".+\\.lhs$" flymake-Haskell-init flymake-simple-java-cleanup)
      flymake-allowed-file-name-masks)
(push '("^\\(\.+\.hs\\|\.lhs\\):\\([0-9]+\\):\\([0-9]+\\):\\(.+\\)" 1 2 3 4) 
      flymake-err-line-patterns)
)
#+END_SRC
* GNUS
#+BEGIN_SRC emacs-lisp
;; (use-package gnus-load
;; :ensure f
;; :config 
;; ;; Configure loadpath
;; (setq load-path (cons (expand-file-name "~/.emacs.d/gnus/lisp") load-path))
;; 
;; ;; Configure info directory
;; (add-to-list 'Info-default-directory-list "~/.emacs.d/gnus/texi/")
;; 
;; ;; Setup emacss mail user agent
;; (setq mail-user-agent 'gnus-user-agent)
;; 
;; ;; Attach bbdb hook
;; (add-hook 'gnus-startup-hook 'bbdb-insinuate-gnus)
;; 
;; ;; Configure S/MIME\\
;; ;; This configuration might not just be for gnus but also for mu4e,
;; ;; but i need to further confirm that
;; (setq mm-decrypt-option 'always)
;; (setq mm-verify-option 'always)
;; (setq gnus-buttonized-mime-types '("multipart/encrypted" "multipart/signed"))
;; 
;; (add-hook 'message-send-hook 'mml-secure-message-sign-smime)
;; 
;; (setq password-cache t) ; default is true, so no need to set this actually
;; (setq password-cache-expiry 86400); default is 16 seconds
;; 
;; ;; (setq mml-signencrypt-style-alist '(("smime" combined)
;; ;;                                     ("pgp" combined)
;; ;;                                     ("pgpmime" combined)))
;; 
;; (setq mml-signencrypt-style-alist '(("smime" separate)
;;                                     ("pgp" separate)
;;                                     ("pgpauto" separate)
;;                                     ("pgpmime" separate)))
;; 
;; )
#+END_SRC
* BBDB 
** Configuring loadpath
#+BEGIN_SRC emacs-lisp
(add-to-list 'load-path "~/.emacs.d/bbdb/lisp/")
#+END_SRC
** Configuring Info directory
#+BEGIN_SRC emacs-lisp
(add-to-list 'Info-default-directory-list "~/.emacs.d/bbdb/texinfo/")
#+END_SRC

** bbdb
#+BEGIN_SRC emacs-lisp
(use-package bbdb
:ensure t
:config
(bbdb-initialize 'gnus 'message)

(setq 
 bbdb-offer-save 1                        ;; 1 means save-without-asking


 bbdb-use-pop-up t                        ;; allow popups for addresses
 bbdb-electric-p t                        ;; be disposable with SPC
 bbdb-popup-target-lines  1               ;; very small
 bbdb-dwim-net-address-allow-redundancy t ;; always use full name
 bbdb-quiet-about-name-mismatches 2       ;; show name-mismatches 2 secs
 bbdb-always-add-address t                ;; add new addresses to existing...
 ;; ...contacts automatically
 ;;     bbdb-canonicalize-redundant-nets-p t     ;; x@foo.bar.cx => x@bar.cx
 bbdb-completion-type nil                 ;; complete on anything
 bbdb-complete-name-allow-cycling t       ;; cycle through matches
 ;; this only works partially
 bbbd-message-caching-enabled t           ;; be fast
 bbdb-use-alternate-names t               ;; use AKA
 bbdb-elided-display t                    ;; single-line addresses

 ;; auto-create addresses from mail
 bbdb/mail-auto-create-p 'bbdb-ignore-some-messages-hook   
 bbdb-ignore-some-messages-alist ;; don't ask about fake addresses
 ;; NOTE: there can be only one entry per header (such as To, From)
 ;; http://flex.ee.uec.ac.jp/texi/bbdb/bbdb_11.html

 '(( "From" . "no.?reply\\|DAEMON\\|daemon\\|facebookmail\\|twitter"))
 )

;; Extract SMime Certificates
(defun DE-get-certificate-files-from-bbdb () 
  (let ((certfiles nil))
    (save-excursion
      (save-restriction
        (message-narrow-to-headers-or-head)
        (let ((names (remq nil (mapcar 'message-fetch-field '("To" "Cc" "From")))))
          (mapc (function (lambda (arg)
                            (let ((rec (bbdb-search-simple nil (cdr arg))))
                              (when rec
                                (let ((cert (bbdb-get-field rec 'certfile)))
                                  (when (and (> (length cert) 0) (not (member cert certfiles)))
                                    (push cert certfiles)(push 'certfile certfiles)))))))
                (mail-extract-address-components (mapconcat 'identity names ",") t)))
        (if (y-or-n-p (concat (mapconcat 'file-name-nondirectory (remq 'certfile certfiles) ", ") ".  Add more certificates? "))
            (nconc (mml-smime-encrypt-query) certfiles)
          certfiles)))))

(add-to-list 'mml-encrypt-alist '("smime" mml-smime-encrypt-buffer DE-get-certificate-files-from-bbdb))

(defun DE-snarf-smime-certificate ()
  (interactive)
  (if (or (assoc "certfile" (bbdb-propnames))
          (progn (when (y-or-n-p "Field 'certfile' does not exist in BBDB. Define it? ")
                   (bbdb-set-propnames 
                    (append (bbdb-propnames) (list (list "certfile"))))
                   t)))
      (if (get-buffer gnus-article-buffer)
          (progn 
            (set-buffer gnus-article-buffer)
            (beginning-of-buffer)
            (if (search-forward "S/MIME Signed Part:Ok" nil t)
                (let* ((data (mm-handle-multipart-ctl-parameter 
                              (get-text-property (point) 'gnus-data) 'gnus-details))
                       (address (progn (string-match "^Sender claimed to be: \\(.*\\)$" data)
                                       (substring data (match-beginning 1) (match-end 1))))
                       (rec (bbdb-search-simple nil address)))
                  (if rec
                      (let* ((certfile (bbdb-get-field rec 'certfile))
                             (filename (bbdb-record-name rec))
                             (dowrite (or (zerop (length certfile)) 
                                          (y-or-n-p "User already has a certfile entry. Overwrite? ")))
                             (begincert nil))
                        (when dowrite
                          (string-match (concat "\\(emailAddress=\\|email:\\)" address) data)
                          (setq begincert (string-match "^-----BEGIN CERTIFICATE-----$" data (match-end 0)))
                          (if (and smime-certificate-directory
                                   (file-directory-p smime-certificate-directory))
                              (progn
                                (setq filename (concat (file-name-as-directory smime-certificate-directory) 
                                                       (mm-file-name-replace-whitespace filename) ".pem"))
                                (when (or (not (file-exists-p filename))
                                          (y-or-n-p (concat "Filename " filename " already exists. Overwrite? "))) 
                                  (string-match "^-----END CERTIFICATE-----$" data begincert)
                                  (write-region (substring data begincert (+ (match-end 0) 1)) nil filename)
                                  (bbdb-record-putprop rec 'certfile filename)
                                  (bbdb-change-record rec t)
                                  (bbdb-redisplay-one-record rec)
                                  (message (concat "Saved certificate and updated BBDB record for " address))))
                            (progn
                              (ding)(message "smime-certificate-directory not correctly set.")))
                          ))
                    (progn
                      (ding)
                      (message (concat "No entry for address " address " in the BBDB.")))))
              (progn (ding)
                     (message "No valid S/MIME signed message found.")))
            )  
        (progn
          (ding)(message "No article buffer available.")))
    (progn
      (ding)(message "No field 'certfile' defined in BBDB."))))
)
#+END_SRC
* ACE Jump mode
** ace-jump-mode
#+BEGIN_SRC emacs-lisp
(use-package ace-jump-mode
:ensure t
:config
(define-key global-map (kbd "C-c SPC") 'ace-jump-mode)
)
#+END_SRC

#+BEGIN_SRC emacs-lisp
;; more powerfull jump back feature
(autoload
	'ace-jump-mode-pop-mark
	"ace-jump-mode"
	"Ace jump back:-)"
	t)
(eval-after-load "ace-jump-mode"
	'(ace-jump-mode-enable-mark-sync))
(define-key global-map (kbd "C-x SPC") 'ace-jump-mode-pop-mark)
#+END_SRC
* Hackernews
Simple Hackernews-frontend

#+BEGIN_SRC emacs-lisp
(use-package hackernews
:ensure t)
#+END_SRC

* Electric Pair Mode
#+begin_src emacs-lisp
  (electric-pair-mode)
#+end_src

* iedit
Change multiple occurences

#+BEGIN_SRC emacs-lisp
(use-package iedit
:ensure t)
#+END_SRC

* frogblogmode
frogblog major mode

#+BEGIN_SRC emacs-lisp
;;(use-package frogblogmode
;;:ensure f
;;:init
;;(add-to-list 'load-path "~/.emacs.d/frogblogmode/")
;;)
#+END_SRC

* multiple cursors
#+BEGIN_SRC emacs-lisp
(use-package multiple-cursors
:ensure t
:config
(global-set-key (kbd "C-S-c C-S-c") 'mc/edit-lines)
(global-set-key (kbd "C->") 'mc/mark-next-like-this)
(global-set-key (kbd "C-<") 'mc/mark-previous-like-this)
(global-set-key (kbd "C-c C-<") 'mc/mark-all-like-this)
)
#+END_SRC

* popup windows
#+BEGIN_SRC emacs-lisp
(use-package popwin
:ensure t
:init
(add-to-list 'load-path "~/.emacs.d/popwin-el")
(add-to-list 'load-path "~/.emacs.d/popwin-el/misc")

:config
;; Popup Windows
(popwin-mode 1)
(global-set-key (kbd "C-=") popwin:keymap)
(global-set-key (kbd "C-= t") 'popwin-term:term)

(push '(term-mode :position :top :height 16 :stick t) popwin:special-display-config)
)
#+END_SRC

* winner mode
to switch back to window configurations

#+BEGIN_SRC emacs-lisp
(winner-mode 1) 
#+END_SRC

* browser
#+BEGIN_SRC emacs-lisp
  ;; Set the Conkeror as emacs default browser
  ;; (setq browse-url-browser-function 'browse-url-generic
  ;;       browse-url-generic-program "/home/frosch03/bin/conky")
  (setq browse-url-browser-function 'browse-url-generic
        browse-url-generic-program "/usr/bin/firefox")
  (setq browse-url-browser-function 'browse-url-default-browser
        browse-url-generic-program "/usr/bin/firefox")
  ;; (setq browse-url-browser-function 'browse-url-generic
  ;;       browse-url-generic-program "/usr/bin/chromium")
#+END_SRC

* flymake
#+BEGIN_SRC emacs-lisp
(when (load "flymake" t)
 (defun flymake-pylint-init ()
   (let* ((temp-file (flymake-init-create-temp-buffer-copy
                      'flymake-create-temp-inplace))
          (local-file (file-relative-name
                       temp-file
                       (file-name-directory buffer-file-name))))
     (list "~/.emacs.d/pyflymake.py" (list local-file))))
 (add-to-list 'flymake-allowed-file-name-masks
              '("\\.py\\'" flymake-pylint-init)))
#+END_SRC

* projectile
#+BEGIN_SRC emacs-lisp
  (use-package projectile
  :ensure t
  :config
  (projectile-global-mode)
  ;; (setq projectile-mode-line " Projectile")
  ;; (setq projectile-indexing-method 'native)
  ;; (setq projectile-enable-caching t)
  (define-key projectile-mode-map (kbd "C-c p") 'projectile-command-map)
  (setq projectile-indexing-method 'hybrid)
  ;; For Tramp to work with projectile
  ;; (add-hook 'text-mode-hook 'projectile-mode)
  ;; ^^ won't work, disable projectile-global-mode for it to work
  )
#+END_SRC

* recentf
#+BEGIN_SRC emacs-lisp
(use-package recentf
:ensure t)
#+END_SRC

* neotree
#+BEGIN_SRC emacs-lisp
(use-package neotree
:ensure t
:config
(global-set-key (kbd "C-<f8>") 'neotree-toggle)
)
#+END_SRC

* ido mode
#+BEGIN_SRC emacs-lisp
(use-package ido-vertical-mode
:ensure t
:config
(ido-mode 1)
(ido-vertical-mode 1)
)
#+END_SRC

* helm
** helm
#+BEGIN_SRC emacs-lisp
(use-package helm
:ensure t
:config
;; must set before helm-config,  otherwise helm use defaut
;; prefix "C-x c", which is inconvenient because you can
;; accidentially pressed "C-x C-c"
(setq helm-command-prefix-key "C-c h")

(define-key helm-map (kbd "<tab>") 'helm-execute-persistent-action) ; rebihnd tab to do persistent action
(define-key helm-map (kbd "C-i") 'helm-execute-persistent-action) ; make TAB works in terminal
(define-key helm-map (kbd "C-z")  'helm-select-action) ; list actions using C-z

(setq
 helm-google-suggest-use-curl-p t
 helm-scroll-amount 4 ; scroll 4 lines other window using M-<next>/M-<prior>
 helm-quick-update t ; do not display invisible candidates
 helm-idle-delay 0.01 ; be idle for this many seconds, before updating in delayed sources.
 helm-input-idle-delay 0.01 ; be idle for this many seconds, before updating candidate buffer
 helm-ff-search-library-in-sexp t ; search for library in `require' and `declare-function' sexp.

 helm-split-window-default-side 'other ;; open helm buffer in another window
 helm-split-window-in-side-p t ;; open helm buffer inside current window, not occupy whole other window
 ;; helm-buffers-favorite-modes (append helm-buffers-favorite-modes
 ;;                                     '(picture-mode artist-mode))
 helm-candidate-number-limit 200 ; limit the number of displayed canidates
 helm-M-x-requires-pattern 0     ; show all candidates when set to 0
 helm-boring-file-regexp-list
 '("\\.git$" "\\.hg$" "\\.svn$" "\\.CVS$" "\\._darcs$" "\\.la$" "\\.o$" "\\.i$") ; do not show these files in helm buffer
 helm-ff-file-name-history-use-recentf t
 helm-move-to-line-cycle-in-source t ; move to end or beginning of source
                                        ; when reaching top or bottom of source.
 ido-use-virtual-buffers t      ; Needed in helm-buffers-list
 helm-buffers-fuzzy-matching t          ; fuzzy matching buffer names when non--nil
                                        ; useful in helm-mini that lists buffers
 )

;; Save current position to mark ring when jumping to a different place
(add-hook 'helm-goto-line-before-hook 'helm-save-current-pos-to-mark-ring)

(helm-mode 1)
)
#+END_SRC

** helm-config
#+BEGIN_SRC emacs-lisp
(use-package helm-config
:ensure f
:config)
#+END_SRC

** helm-eshell
#+BEGIN_SRC emacs-lisp
(use-package helm-eshell
:ensure f
:config)
#+END_SRC

** helm-files
#+BEGIN_SRC emacs-lisp
(use-package helm-files
:ensure f
:config)
#+END_SRC

** helm-grep
#+BEGIN_SRC emacs-lisp
(use-package helm-grep
:ensure f
:config
(define-key helm-grep-mode-map (kbd "<return>")  'helm-grep-mode-jump-other-window)
(define-key helm-grep-mode-map (kbd "n")  'helm-grep-mode-jump-other-window-forward)
(define-key helm-grep-mode-map (kbd "p")  'helm-grep-mode-jump-other-window-backward)
)
#+END_SRC

* isearch
#+BEGIN_SRC emacs-lisp
;; Bind C-Tab to make a highlightion from an isearch
(defun isearch-highlight-phrase ()
  "Invoke `highligh-phrase' from within isearch."
  (interactive)
  (let ((case-fold-search isearch-case-fold-search))
    (highlight-phrase (if isearch-regexp
                          isearch-string
                        (regexp-quote isearch-string)))))

(define-key isearch-mode-map (kbd "C-<tab>") 'isearch-highlight-phrase)
#+END_SRC

* rvm el
#+BEGIN_SRC emacs-lisp
;; rvm el
(use-package rvm
:ensure t
:config
(rvm-use-default) ;; use rvm's default ruby for the current Emacs session
)
#+END_SRC

* w3m
#+BEGIN_SRC emacs-lisp
  ;; w3m basic configuration
  ;; (setq browse-url-browser-function 'w3m-browse-url)
   (autoload 'w3m-browse-url "w3m" "Ask a WWW browser to show a URL." t)
   ;; optional keyboard short-cut
   (global-set-key "\C-xm" 'browse-url-at-point)

  ;; anyhow, set the brower to the -firefox- chromium
  ;; (setq browse-url-browser-function 'browse-url-firefox)
  ;; (setq browse-url-browser-function 'browse-url-chromium)
#+END_SRC

* mu4e
#+BEGIN_SRC emacs-lisp
  (use-package mu4e
    :ensure f
    :config
    (global-set-key (kbd "C-x m") 'mu4e)
    (setq
     mu4e-maildir       "~/Mail"   ;; top-level Maildir
     mu4e-sent-folder   "/frosch03/Sent"       ;; folder for sent messages
     mu4e-drafts-folder "/drafts"     ;; unfinished messages
     mu4e-trash-folder  "/frosch03/Trash"      ;; trashed messages
     mu4e-refile-folder "/archive"   ;; saved messages
     mu4e-change-filenames-when-moving t) ;; https://stackoverflow.com/a/43461973

    (setq
     ;; mu4e-get-mail-command "offlineimap"   ;; or fetchmail, or ...
     mu4e-get-mail-command "~/bin/offlineimap-notify.py" ;
     mu4e-get-mail-command "mbsync -a"
     mu4e-update-interval 300)             ;; update every 5 minutes

    ;; tell message-mode how to send mail
    (setq user-mail-address "frosch03@frosch03.de")
    (setq user-full-name "Matthias Brettschneider")
    (setq mu4e-compose-signature-auto-include nil) ;; insert signature with C-c C-w
    (setq mu4e-compose-signature "open source, open minds, open future")

    ;; configuration within: private_config.org
    ;; (setq message-send-mail-function 'smtpmail-send-it
    ;;       smtpmail-starttls-credentials '(("<servername>" <port> nil nil))
    ;;       smtpmail-auth-credentials '(("<servername>" <port> "<username>" nil))
    ;;       smtpmail-default-smtp-server "<servername>"
    ;;       smtpmail-smtp-server "<servername>"
    ;;       smtpmail-smtp-service <port>
    ;;       smtpmail-local-domain "<domain>")

    (add-to-list 'mu4e-view-actions
                 '("ViewInBrowser" . mu4e-action-view-in-browser) t)
    ;; (add-to-list 'mu4e-bookmarks
    ;;              '("((date:7D..now) AND not (maildir:/frosch03/Trash OR maildir:/gmail/[Gmail].Trash OR maildir:/gmail/[Gmail].Spam OR maildir:/frosch03/Spam OR maildir:\"/gmail/[Gmail].All Mail\") AND not flag:trashed)" "No Trash" ?b))
    (add-to-list 'mu4e-bookmarks
                 '("(((date:30d..now) AND not flag:trashed) AND (maildir:/frosch03/INBOX OR maildir:/gmail/INBOX)) AND not v:OSCC*" "Inbox" ?i))
    ;; (add-to-list 'mu4e-bookmarks '("(((date:30d..now) AND not
    ;;              flag:trashed) AND (maildir:/frosch03/INBOX OR
    ;;              maildir:/gmail/INBOX)) AND v:OSCC*" "Lists (OSCC*)" ?l))
    ;; (add-to-list 'mu4e-bookmarks '("v:vp-* OR v:kistenpost* OR v:budget* OR v:website* OR v:rezepte*" "SoLaWi Lists" ?s))

    ;; (setq mu4e-html2text-command "html2text -utf8 -nobs -width 72")
    (setq mu4e-html2text-command "w3m -T text/html")
    )
#+END_SRC

In order to generate html mails from org-mode, this function helps to
add some org configurations before the output is created. Here:

- imagemagick is selected for cutting the latex formulas into little
  snippits. Also
- the table of content is disabled
  #+BEGIN_SRC lisp
  (defun frog/mu4e-org-compose ()
    "Switch to/from mu4e-compose-mode and org-mode"
     (interactive)
     ;;(if (not (boundp 'kdm/mu4e-org-html-opt-done))
     (let ((p (point)))
       (goto-char (point-min))
       (let ((case-fold-search t))
         (when (not (search-forward "#+OPTIONS: tex:imagemagick" nil t))
           (goto-char (point-max))
           (insert "\n#+OPTIONS: tex:imagemagick\n#+OPTIONS: toc:0\n")))
       (goto-char p))
     (if (eq 'mu4e-compose-mode (buffer-local-value 'major-mode (current-buffer)))
         (org~mu4e-mime-switch-headers-or-body)
       (mu4e-compose-mode)))
  (global-set-key "\M-@" 'frog/mu4e-org-compose)
  #+END_SRC

* jekyll
#+BEGIN_SRC emacs-lisp
(use-package hyde
:ensure t
:config
(setq hyde/hyde-list-posts-command "/bin/ls -ltr *.md"
      hyde-home "/home/frosch03/Documents/Blog")
;; (setq hyde/hyde-list-posts-command "/bin/ls -ltr *.md"
;;       hyde/git/remote "master"   ; The name of the branch on which your blog resides
;;       hyde/deploy-command  "rsync -vr _site/* nkv@ssh.hcoop.net:/afs/hcoop.net/user/n/nk/nkv/public_html/nibrahim.net.in/" ; Command to deploy
;;       hyde-custom-params '(("category" "personal")
;; 			   ("tags" "")
;; 			   ("cover" "false")
;; 			   ("cover-image" ""))
;;       )
)
#+END_SRC

* gnugol
#+BEGIN_SRC emacs-lisp
;; gnugol
(add-to-list 'load-path "~/.emacs.d/gnugol/")
(autoload 'gnugol "gnugol")
(global-set-key (kbd "C-c C-g") 'gnugol)
#+END_SRC

* sunrise commander
#+BEGIN_SRC emacs-lisp
;; sunrise commander
(add-to-list 'load-path "~/.emacs.d/sunrise-commander/")
(autoload 'sunrise-commander "sunrise-commander")
;; (require 'sunrise-commander)
#+END_SRC

* yassnippets
#+BEGIN_SRC emacs-lisp
(setq yas-snippet-dirs
      '("~/.emacs.d/snippets"                 ;; personal snippets
        "~/.emacs.d/snippets"                 ;; the default collection
        ))
#+END_SRC

* weechat
# #+BEGIN_SRC emacs-lisp
# (use-package weechat
# :ensure t)
# #+END_SRC

* tramp
#+BEGIN_SRC emacs-lisp
(use-package tramp
:ensure t
:config
(setq tramp-default-method "ssh")
(eval-after-load 'tramp '(setenv "SHELL" "/bin/sh"))
)
#+END_SRC

* nginxmode
#+BEGIN_SRC emacs-lisp
(use-package nginx-mode
:ensure t)
#+END_SRC

* elfeed
#+BEGIN_SRC emacs-lisp
  (use-package elfeed
    :ensure elfeed-org
    :config
    (global-set-key (kbd "C-x w") 'elfeed)
    (elfeed-org)
    (setq rmh-elfeed-org-files (list "~/Org/feeds.org"))
    )
#+END_SRC

* eww
- Give eww a global key binding
  #+begin_src emacs-lisp
    (global-set-key (kbd "C-x e") 'eww)
  #+end_src
- This here is to toggle images in eww buffers on and off
  #+BEGIN_SRC emacs-lisp
  (defvar-local endless/display-images t)

  (defun endless/toggle-image-display ()
    "Toggle images display on current buffer."
    (interactive)
    (setq endless/display-images
          (null endless/display-images))
    (endless/backup-display-property endless/display-images))

  (defun endless/backup-display-property (invert &optional object)
    "Move the 'display property at POS to 'display-backup.
  Only applies if display property is an image.
  If INVERT is non-nil, move from 'display-backup to 'display
  instead.
  Optional OBJECT specifies the string or buffer. Nil means current
  buffer."
    (let* ((inhibit-read-only t)
           (from (if invert 'display-backup 'display))
           (to (if invert 'display 'display-backup))
           (pos (point-min))
           left prop)
      (while (and pos (/= pos (point-max)))
        (if (get-text-property pos from object)
            (setq left pos)
          (setq left (next-single-property-change pos from object)))
        (if (or (null left) (= left (point-max)))
            (setq pos nil)
          (setq prop (get-text-property left from object))
          (setq pos (or (next-single-property-change left from object)
                        (point-max)))
          (when (eq (car prop) 'image)
            (add-text-properties left pos (list from nil to prop) object))))))
  #+END_SRC

- Bind that endless/display-images function to a key
  #+BEGIN_SRC emacs-lisp
  (add-hook 'eww-mode-hook
            (lambda ()
              (local-set-key (kbd "C-c C-t") 'endless/toggle-image-display)))
  #+END_SRC

* RESTclient
#+BEGIN_SRC emacs-lisp
  (use-package restclient
    :ensure t
    )
#+END_SRC

* mpdel
Using mpdel mode for navigation of mpd
#+BEGIN_SRC emacs-lisp
  (use-package mpdel
    :ensure t
    :config
    (mpdel-mode)
    )
#+END_SRC

* org-roam
The configuration of org roam is done as it is suggested on the org
roam page

Define a function to call from the outside
#+begin_src emacs-lisp
  (defun make-capture-today-frame ()
    "Create a new frame and run org-roam-dailies-capture-today."
    (interactive)
    (org-roam-dailies-capture-today)
    (delete-other-windows)
    )
#+end_src

#+begin_src emacs-lisp
  (global-set-key (kbd "C-c n d")
                  (lambda ()
                    (interactive)
                    (find-file "~/Org/Roam/20230104232111-index.org")))
  (global-set-key (kbd "C-c n z")
                  (lambda ()
                    (interactive)
                    (load-library "dired-x")
                    (dired "~/Org/Roam/")
                    (dired-omit-mode)
                    (dired-sort-other "-alhr --time-style=+ --group-directories-first")))

  (global-set-key (kbd "C-c n w")
                  (lambda ()
                    (interactive)
                    (load-library "dired-x")
                    (dired "~/Org/Wissensdatenbank/")
                    (dired-omit-mode)
                    (dired-sort-other "-alh --time-style=+ --group-directories-first")))
#+end_src

#+begin_src emacs-lisp
  (setq org-roam-v2-ack t)
  (use-package org-roam
    :ensure t
    :custom
    (org-roam-directory (file-truename "~/Org/Roam/"))
    :bind (("C-c n l" . org-roam-buffer-toggle)
           ("C-c n f" . org-roam-node-find)
           ("C-c n g" . org-roam-graph)
           ("C-c n i" . org-roam-node-insert)
           ("C-c n c" . org-roam-capture)
           ;; ("C-c n j" . org-roam-jump-to-index)
           ;; Dailies
           ("C-c n t" . org-roam-dailies-capture-today))
    :hook (after-init . org-roam-setup)

    :config
    (org-roam-db-autosync-mode)
    (add-hook 'org-roam-mode-hook
              (lambda ()
                (setq-local display-buffer--same-window-action
                            '(display-buffer-use-some-window
                              (main)))))

    ;; If using org-roam-protocol
    (require 'org-roam-protocol))
#+end_src

The configuration of org roam is done as it is suggested on the [[https://org-roam.readthedocs.io/en/master/installation/][org
roam page]]
# #+BEGIN_SRC emacs-lisp
#   (use-package org-roam
#     :hook
#     (after-init . org-roam-mode)
#     :custom
#     (org-roam-directory "~/Org/Roam/")
#     :bind (:map org-roam-mode-map
#                 (("C-c n l" . org-roam)
#                  ("C-c n f" . org-roam-find-file)
#                  ("C-c n j" . org-roam-jump-to-index)
#                  ("C-c n b" . org-roam-switch-to-buffer)
#                  ("C-c n g" . org-roam-graph))
#                 :map org-mode-map
#                 (("C-c n i" . org-roam-insert))))
# #+END_SRC

** company-org-roam
In order to get link completion, company org roam is used. As I don't
want to jump currently also into straight.el, I'm using require syntax
here and cloned the git repositry by hand.
# #+BEGIN_SRC emacs-lisp
#   (add-to-list 'load-path "~/.emacs.d/company-org-roam/")
#   (require 'company-org-roam)
#   (push 'company-org-roam company-backends)
# #+END_SRC

* ebib
Configuration of ebib together with roam within my dropbox folder
#+begin_src emacs-lisp
  (use-package ebib
    :ensure t
    :config
    (global-set-key "\C-cne" 'ebib)
    :custom
    (ebib-preload-bib-files '("Literatur.bib"))
    (ebib-bib-search-dirs '("/home/frosch03/Dropbox/roam/"))
    ;; (global-set-key "\C-cne" '(ebib-open-bibtex-file "~/Org/Roam/Literatur.bib"))
    )
#+end_src

* Haskell LSP
#+begin_src emacs-lisp
  ;; (use-package lsp-mode
  ;;   :init
  ;;   ;; set prefix for lsp-command-keymap (few alternatives - "C-l", "C-c l")
  ;;   (setq lsp-keymap-prefix "C-c l")
  ;;   (add-hook 'haskell-mode-hook #'lsp)
  ;;   (add-hook 'haskell-literate-mode-hook #'lsp)
  ;;   :hook ((haskell-mode . lsp)
  ;;          ;; if you want which-key integration
  ;;          ;; (lsp-mode . lsp-enable-which-key-integration)
  ;;          )
  ;;   :commands lsp)

  ;; optionally
  ;; ;; (use-package lsp-ui :commands lsp-ui-mode)
  ;; if you are helm user
  ;; ;; (use-package helm-lsp :commands helm-lsp-workspace-symbol)
  ;; if you are ivy user
  ;; ;; (use-package lsp-ivy :commands lsp-ivy-workspace-symbol)
  ;; ;; (use-package lsp-treemacs :commands lsp-treemacs-errors-list)

  ;; ;; optionally if you want to use debugger
  ;; (use-package dap-mode)
  ;; ;; (use-package dap-LANGUAGE) to load the dap adapter for your language

  ;; ;; optional if you want which-key integration
  ;; (use-package which-key
  ;;   :config
  ;;   (which-key-mode))

  ;; (use-package eglot
  ;;   :ensure t
  ;;   :config
  ;;   (add-to-list 'eglot-server-programs '(haskell-mode . ("ghcide" "--lsp"))))

  (use-package haskell-snippets
    :ensure t
    :config
    (add-hook 'haskell-mode-hook 'yas-minor-mode)
    )

  ;; LSP
  (use-package flycheck
    :ensure t
    :init
    (global-flycheck-mode t))
  (use-package lsp-mode
    :ensure t
    :init
    ;; set prefix for lsp-command-keymap (few alternatives - "C-l", "C-c l")
    (setq lsp-keymap-prefix "C-c l")
    (add-hook 'haskell-mode-hook #'lsp)
    (add-hook 'haskell-literate-mode-hook #'lsp)
    :hook (haskell-mode . lsp)
    :commands lsp)

  (use-package lsp-ui
    :ensure t
    :commands lsp-ui-mode)

  (use-package lsp-haskell
    :ensure t
    :config
    (setq lsp-haskell-server-path "/home/frosch03/.cabal/bin/haskell-language-server")
    ;; (setq lsp-haskell-server-path "haskell-language-server-8.6.5")
    (setq lsp-haskell-server-args ())
    ;; (setq lsp-haskell-process-path-hie "ghcide")
    ;; (setq lsp-haskell-process-args-hie '())
    ;; Comment/uncomment this line to see interactions between lsp client/server.
    (setq lsp-log-io t)
    )
#+end_src

** company mode
#+begin_src emacs-lisp
  (use-package company
    :ensure t
    :config
    (add-hook 'after-init-hook 'global-company-mode)
    )
#+end_src

* Ormolu
#+begin_src emacs-lisp
  (use-package ormolu
    :ensure t
    :hook (haskell-mode . ormolu-format-on-save-mode)
    :config (setq ormolu-cabal-default-extensions t)
    :bind (:map haskell-mode-map
                ("C-c r" . ormolu-format-buffer))
    )
#+end_src
* COMMENT Haskell LSP
#+begin_src emacs-lisp
  (use-package lsp-mode
    :ensure t
    :init
    (setq lsp-keymap-prefix "C-c l")
    (add-hook 'haskell-mode-hook #'lsp)
    (add-hook 'haskell-literate-mode-hook #'lsp)
    :hook ((haskell-mode . lsp)
           ;; if you want which-key integration
           ;; (lsp-mode . lsp-enable-which-key-integration)
           )
    :commands lsp
    )

  (use-package lsp-ui
    :ensure f
    :commands lsp-ui-mode
    )

  (use-package lsp-haskell
    :ensure t
    :config
    (setq lsp-haskell-process-path-hie "ghcide")
    (setq lsp-haskell-process-args-hie '())
    )
#+end_src

** Company Mode
#+begin_src emacs-lisp
  (use-package company
    :ensure t
    :config
    (add-hook 'after-init-hook 'global-company-mode)
    )
#+end_src

** Ormolu
#+begin_src emacs-lisp
  (use-package ormolu
    :ensure t
    :hook (haskell-mode . ormolu-format-on-save-mode)
    :config (setq ormolu-cabal-default-extensions t)
    :bind (:map haskell-mode-map
                ("C-c r" . ormolu-format-buffer)))
#+end_src

** Fixme Mode
#+begin_src emacs-lisp
  (use-package fixme-mode
    :ensure f
    :load-path "~/.emacs.d/fixme-mode/"
    :config
    (setq fixme-highhlighted-words '("FIXME" "TODO" "BUG" "HACK"))
    (add-hook 'prog-mode-hook #'fixme-mode)
    )
#+end_src

* org-static-blog
#+begin_src emacs-lisp
  (use-package org-static-blog
    :ensure t
    :config
    (setq org-static-blog-publish-title "frosch03.de/blog")
    (setq org-static-blog-publish-url "https://frosch03.de/blog")
    (setq org-static-blog-publish-directory "~/Org/Blog/")
    (setq org-static-blog-posts-directory "~/Org/Blog/posts/")
    (setq org-static-blog-index-length 7)
    (setq org-static-blog-use-preview t)
    (setq org-static-blog-drafts-directory "~/Org/Blog/drafts/")
    (setq org-static-blog-enable-tags t)
    (setq org-export-with-toc nil)
    (setq org-export-with-section-numbers nil)

    ;; This header is inserted into the <head> section of every page:
    ;;   (you will need to create the style sheet at
    ;;    ~/projects/blog/static/style.css
    ;;    and the favicon at
    ;;    ~/projects/blog/static/favicon.ico)
    (setq org-static-blog-page-header
          "<link href=\"https://fonts.googleapis.com/css?family=Jura\" rel=\"stylesheet\" type=\"text/css\">
           <script src=\"static/respond.js\"></script>
           <link href=\"static/theme.css\" rel=\"stylesheet\" type=\"text/css\">
           <meta name=\"author\" content=\"Matthias Brettschneider\">")

    ;; This preamble is inserted at the beginning of the <body> of every page:
    ;;   This particular HTML creates a <div> with a simple linked headline
    (setq org-static-blog-page-preamble
          "<div class=\"container-fluid\" style=\"padding:0px\">
            <div class=\"row-fluid\">
              <div class=\"navbar navbar-inverse navbar-static-top\" role=\"navigation\">
                <div class=\"navbar-header\">
                  <button type=\"button\" class=\"navbar-toggle\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\">
                    <span class=\"sr-only\"></span>
                    <span class=\"icon-bar\"></span>
                    <span class=\"icon-bar\"></span>
                    <span class=\"icon-bar\"></span>
                  </button>
                </div>
                <div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\">
                  <ul class=\"nav navbar-nav\">
                    <li class=\"active\"><a href=\"/blog/\">Home</a></li>
                    <li class=\"active\"><a href=\"/blog/archive.html\">Archive</a></li>
                    <li class=\"active\"><a href=\"/blog/rss.xml\">RSS</a></li>

                    <li class=\"active\"><a href=\"https://github.com/frosch03\">Github</a></li>

                  </ul>
                </div>
              </div>
            </div>
          </div>")

    ;; This postamble is inserted at the end of the <body> of every page:
    ;;   This particular HTML creates a <div> with a link to the archive page
    ;;   and a licensing stub.
    (setq org-static-blog-page-postamble
          "<div id=\"archive\">
          <a href=\"https://frosch03.de/blog/archive.html\">Other posts</a>
          </div>
          <center><a rel=\"license\" href=\"https://creativecommons.org/licenses/by-sa/3.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by-sa/3.0/88x31.png\" /></a><br /><span xmlns:dct=\"https://purl.org/dc/terms/\" href=\"https://purl.org/dc/dcmitype/Text\" property=\"dct:title\" rel=\"dct:type\">frosch03.de</span> by <a xmlns:cc=\"https://creativecommons.org/ns#\" href=\"https://frosch03.de\" property=\"cc:attributionName\" rel=\"cc:attributionURL\">Matthias Brettschneider</a> is licensed under a <a rel=\"license\" href=\"https://creativecommons.org/licenses/by-sa/3.0/\">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.</center>")

    ;; This HTML code is inserted into the index page between the preamble and
    ;;   the blog posts
    (setq org-static-blog-index-front-matter
          "<a class=\"navbar-brand\" href=\"/blog/\" class=\"hidden-xs\">
             <h1>frosch03.de/blog </h1>
           </a>\n")
    )
#+end_src

* Mastodon
#+begin_src emacs-lisp
  (use-package mastodon
    :ensure t
    :config
    (global-set-key (kbd "C-x a") 'mastodon)
    (mastodon-discover)
    (setq mastodon-instance-url "https://social.frosch03.de")
    (setq mastodon-active-user "frosch03@social.frosch03.de")
    )
#+end_src

* eyebrowse
#+begin_src emacs-lisp
  (use-package eyebrowse
    :ensure f
    :config
    (setq desktop-save-mode 1)
    (eyebrowse-mode)
    )
#+end_src
#+end_src

